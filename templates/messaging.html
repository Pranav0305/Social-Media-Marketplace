{% extends "layout.html" %}
{% block title %}Direct Messaging{% endblock %}

{% block content %}
    {% if not session.get('user_id') %}
        <h2>You need to log in first.</h2>
        <p>To send or view messages, please <a href="{{ url_for('auth.login') }}">log in</a> or <a href="{{ url_for('auth.register') }}">register</a>.</p>
    {% else %}
        <h2>Direct Messaging</h2>
        <form method="POST">
            <label>Recipient Username:</label> 
            <input type="text" name="recipient" required><br>
            <label>Message:</label> 
            <textarea name="message" required></textarea><br>
            <input type="submit" value="Send Message">
        </form>

        <h3>Your Messages</h3>
        <ul>
            {% for msg in messages %}
            <li>
                <strong>From:</strong> {{ msg.sender_username }} |
                <strong>To:</strong> {{ msg.recipient_username }}<br>
                <strong>Message:</strong> {{ msg.message }}
            </li>
            {% endfor %}
        </ul>
    {% endif %}
{% endblock %}
