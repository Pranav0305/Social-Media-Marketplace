<h2>Enter OTP to Reset Password</h2>

<form method="POST" id="otpForm">
    <!-- OTP input (read-only, only via virtual keyboard) -->
    <label for="otpInput">OTP:</label>
    <input type="text" id="otpInput" name="otp" placeholder="Enter OTP" readonly maxlength="6"
           style="font-size: 18px; padding: 8px;" required />

    <!-- New password -->
    <label for="password">New Password:</label>
    <input type="password" name="password" required style="padding: 8px;"><br>

    <!-- Virtual Keyboard -->
    <div id="keyboard" style="margin-top: 15px;">
        {% for row in [0, 1, 2] %}
            <div style="margin-bottom: 5px;">
                {% for col in [1, 2, 3] %}
                    {% set digit = row * 3 + col %}
                    <button type="button" onclick="appendDigit('{{ digit }}')">{{ digit }}</button>
                {% endfor %}
            </div>
        {% endfor %}
        <div>
            <button type="button" onclick="clearInput()">Clear</button>
            <button type="button" onclick="appendDigit('0')">0</button>
            <button type="button" onclick="backspace()">‚Üê</button>
        </div>
    </div>

    <button type="submit" style="margin-top: 15px;">Reset Password</button>
</form>

<script>
    function appendDigit(digit) {
        const input = document.getElementById('otpInput');
        if (input.value.length < 6) {
            input.value += digit;
        }
    }

    function clearInput() {
        document.getElementById('otpInput').value = '';
    }

    function backspace() {
        const input = document.getElementById('otpInput');
        input.value = input.value.slice(0, -1);
    }

    // Extra security: disable all manual typing
    const otpInput = document.getElementById('otpInput');
    otpInput.addEventListener('keydown', e => e.preventDefault());
    otpInput.addEventListener('paste', e => e.preventDefault());
</script>
