{% extends "layout.html" %}
{% block title %}View Products{% endblock %}

{% block content %}
<h2>Available Products</h2>

<!-- Inline CSS for table styling -->
<style>
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
    table-layout: fixed; /* Ensures columns have fixed widths */
  }
  th, td {
    border: 1px solid #ccc;
    padding: 8px;
    vertical-align: top; /* Align text to top for better readability */
  }
  th {
    background-color: #f2f2f2;
  }
  /* Column width assignments */
  .id-col {
    width: 15%;
    word-break: break-all; /* Breaks long product IDs */
  }
  .name-col {
    width: 15%;
  }
  .seller-col {
    width: 15%;
  }
  .price-col {
    width: 10%;
  }
  .description-col {
    width: 30%;
    word-wrap: break-word; /* Wraps text to a new line */
    overflow-wrap: break-word;
  }
  .action-col {
    width: 15%;
    text-align: center;
  }
</style>

<nav>
  <a href="/">Home</a>
  <a href="/add_product">Add Product</a>
</nav>
<form method="GET" action="{{ url_for('marketplace.view_products') }}">
  <input type="text" name="search" placeholder="Search products..."
         value="{{ search_query if search_query else '' }}">
  <input type="submit" value="Search">
</form>

<table>
  <thead>
    <tr>
      <th class="id-col">Product ID</th>
      <th class="name-col">Name</th>
      <th class="seller-col">Seller Username</th>
      <th class="price-col">Price</th>
      <th class="description-col">Description</th>
      <th class="action-col">Action</th>
    </tr>
  </thead>
  <tbody>
    {% for product in products %}
    <tr>
      <td class="id-col">{{ product._id }}</td>
      <td class="name-col">{{ product.product_name }}</td>
      <td class="seller-col">{{ product.product_seller_username }}</td>
      <td class="price-col">${{ product.product_price }}</td>
      <td class="description-col">{{ product.product_description }}</td>
      <td class="action-col">
        <a href="{{ url_for('marketplace.buy_product', product_id=product._id) }}">Buy Now</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<p><a href="/">Go Back</a></p>
{% endblock %}
